download.file("https://www.sg.ethz.ch/media/medialibrary/2016/09/02_IPP_Popularity.zip", destfile="02_IPP_Popularity.zip")
unzip("02_IPP_Popularity.zip", exdir = "./")
file.remove("02_IPP_Popularity.zip")
library(texreg)
library(arm)
load("mFC.RData")
load("mB.RData")
screenreg(list(mB, mFC), digits=4)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
rm(list=ls())
data <- read.table("PopularityDataTrain.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
library(arm)
f <- data$followers2>0 & data$followers > 0 & data$incore > 0
seldata <- data.frame(f2=data$followers2[f], f1=data$followers[f], c=relevel(as.factor(data$continent[f]), ref="T"), incore = data$incore[f], incoreHard = data$incoreHard[f])
seldata <- data.frame(f2=data$followers2[f], f1=data$followers[f], incore = data$incore[f])
nullM <- bayesglm(log(f2)~1, data=seldata)
save(nullM, file="nullM.RData")
rm(list=ls())
librar(arm)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
f <- testdata$followers2>0 & testdata$followers > 0 & testdata$incore > 0
seldatatest <-testdata[,f]
load("nullM.RData")
mean(abs(nullM$fitted.values-nullM$y))
mean(abs(predict(nullM, seldatatest)-log(seldatatest$f2)))
rm(list=ls())
library(arm)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
rm(list=ls())
library(arm)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
f <- testdata$followers2>0 & testdata$followers > 0 & testdata$incore > 0
seldatatest <-testdata[,f]
load("nullM.RData")
mean(abs(nullM$fitted.values-nullM$y))
mean(abs(predict(nullM, seldatatest)-log(seldatatest$f2)))
rm(list=ls())
library(arm)
library(dplyr)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
testdata %>% filter(followers2>0 & followers > 0 & incore > 0) -> seldatatest
load("nullM.RData")
mean(abs(nullM$fitted.values-nullM$y))
mean(abs(predict(nullM, seldatatest)-log(seldatatest$f2)))
names(seldatatest)
rm(list=ls())
library(arm)
library(dplyr)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
testdata %>% filter(followers2>0 & followers > 0 & incore > 0) -> testdata
seldatatest <- data.frame(f2=testdata$followers2, f1=testdata$followers, incore = testdata$incore)
load("nullM.RData")
mean(abs(nullM$fitted.values-nullM$y))
mean(abs(predict(nullM, seldatatest)-log(seldatatest$f2)))
load("mF.RData")
mean(abs(mF$fitted.values-mF$y))
mean(abs(predict(mF, seldatatest)-log(seldatatest$f2)))
download.file("https://www.sg.ethz.ch/media/medialibrary/2016/09/02_IPP_Popularity.zip", destfile="02_IPP_Popularity.zip")
unzip("02_IPP_Popularity.zip", exdir = "./")
file.remove("02_IPP_Popularity.zip")
data <- read.table("PopularityDataTrain.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
names(data)
library(arm)
f <- data$followers2>0 & data$followers > 0 & data$incore > 0
seldata <- data.frame(f2=data$followers2[f], f1=data$followers[f], incore = data$incore[f], group= data$group[f])
names(data)
rm(list=ls())
download.file("https://www.sg.ethz.ch/media/medialibrary/2016/09/02_IPP_Popularity.zip", destfile="02_IPP_Popularity.zip")
unzip("02_IPP_Popularity.zip", exdir = "./")
file.remove("02_IPP_Popularity.zip")
data <- read.table("PopularityDataTrain.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
rm(list=ls())
download.file("https://www.sg.ethz.ch/media/medialibrary/2016/09/02_IPP_Popularity.zip", destfile="02_IPP_Popularity.zip")
unzip("02_IPP_Popularity.zip", exdir = "./")
file.remove("02_IPP_Popularity.zip")
data <- read.table("PopularityDataTrain.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
library(arm)
f <- data$followers2>0 & data$followers > 0 & data$incore > 0
seldata <- data.frame(f2=data$followers2[f], f1=data$followers[f], incore = data$incore[f], group= data$group[f])
mFC <- bayesglm(log(f2)~log(f1)*group, data=seldata)
save(mFC, file="mFC.RData")
par(mar=c(4,5,0.5,0.5))
f1 <- exp(seq(0, log(max(data$followers)), by=0.1))
group <- c(rep("S",length(f1)),rep("I",length(f1)),rep("O",length(f1)),rep("T",length(f1)))
newdata <- data.frame(f1=rep(f1,4), group=group)
preds <- predict(mFC, newdata,se.fit =TRUE)
plot(f1, exp(preds$fit[group=="S"]), type="l", log="xy", ylim=range(c(exp(preds$fit+preds$se.fit),exp(preds$fit-preds$se.fit))), xlab="Popularity in 2009", ylab="Popularity in 2016", lwd=2, xaxt="n", yaxt="n", cex.lab=1.5)
polygon(c(f1, rev(f1)), c(exp(preds$fit[continent=="S"]+preds$se.fit[continent=="S"]), rev(exp(preds$fit[group=="S"]-preds$se.fit[continent=="S"]))), col=rgb(0,0,0,0.25), border="black", lty=2)
polygon(c(f1, rev(f1)), c(exp(preds$fit[group=="O"]+preds$se.fit[group=="O"]), rev(exp(preds$fit[group=="O"]-preds$se.fit[group=="O"]))), col=rgb(1,0,0,0.25), border="red", lty=2)
lines(f1, exp(preds$fit[group=="O"]), col="red", lwd=2)
polygon(c(f1, rev(f1)), c(exp(preds$fit[group=="I"]+preds$se.fit[continent=="I"]), rev(exp(preds$fit[group=="I"]-preds$se.fit[group=="I"]))), col=rgb(0,0,1,0.05), border="blue", lty=2)
lines(f1, exp(preds$fit[group=="I"]), col="blue", lwd=2)
polygon(c(f1, rev(f1)), c(exp(preds$fit[group=="T"]+preds$se.fit[group=="T"]), rev(exp(preds$fit[group=="T"]-preds$se.fit[group=="T"]))), col=rgb(1,0,1,0.05), border=rgb(1,0,1), lty=2)
lines(f1, exp(preds$fit[group=="T"]), col=rgb(1,0,1,1), lwd=2)
legend("topleft", c("SCC","Out","In","Rest"), col=c("black", "red", "blue", rgb(1,0,1)), lwd=rep(2,4), box.lwd=-1)
abline(0,1, lty=3, lwd=2)
library(sfsmisc)
eaxis(1,cex.axis=1.25, at=10^seq(0,6))
eaxis(2,cex.axis=1.25, at=10^seq(1,5))
rm(list=ls())
library(arm)
library(dplyr)
testdata <- read.table("PopularityDataTest.dat", header=T, sep="\t",
colClasses=c("integer", "character", rep("integer", 2)))
testdata %>% filter(followers2>0 & followers > 0 & incore > 0) -> testdata
seldatatest <- data.frame(f2=testdata$followers2, f1=testdata$followers, incore = testdata$incore, group=testdata$group)
load("nullM.RData")
mean(abs(nullM$fitted.values-nullM$y))
mean(abs(predict(nullM, seldatatest)-log(seldatatest$f2)))
load("mF.RData")
mean(abs(mF$fitted.values-mF$y))
mean(abs(predict(mF, seldatatest)-log(seldatatest$f2)))
load("mI.RData")
mean(abs(mI$fitted.values-mI$y))
mean(abs(predict(mI, seldatatest)-log(seldatatest$f2)))
load("mB.RData")
mean(abs(mB$fitted.values-mB$y))
mean(abs(predict(mB, seldatatest)-log(seldatatest$f2)))
load("mFC.RData")
mean(abs(mFC$fitted.values-mFC$y))
mean(abs(predict(mFC, seldatatest)-log(seldatatest$f2)))
